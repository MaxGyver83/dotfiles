#!/bin/sh
if [ "$1" = '-h' ] || [ "$1" = '--help' ]; then
    echo "Usage:
list_includes                : List all include lines
list_includes --skip-system  : List all include lines except system headers (like <foo>)
list_includes --raw          : List all include file names except system headers
"
    exit 0
fi

includes="$(rg -tc -tcpp --no-filename '#include' | sed 's: *//.*$::' | sort -u)"

if [ "$1" = '--raw' ]; then
    echo "$includes" | grep -Ev '<[^/]+>' | sed -E -e 's/ *#include +//' -e 's/.(.*)./\1/' | sort -u
elif [ "$1" = '--skip-system' ]; then
    echo "$includes" | grep -Ev '<[^/]+>'
else
    echo "$includes"
fi
